% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[
]{article}
\usepackage{amsmath,amssymb}
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math} % this also loads fontspec
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
\usepackage{lmodern}
\ifPDFTeX\else
  % xetex/luatex font selection
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\usepackage[margin=1in]{geometry}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\usepackage{soul}
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{-\maxdimen} % remove section numbering
\ifLuaTeX
  \usepackage{selnolig}  % disable illegal ligatures
\fi
\IfFileExists{bookmark.sty}{\usepackage{bookmark}}{\usepackage{hyperref}}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\urlstyle{same}
\hypersetup{
  pdftitle={Data Wrangling (1)},
  pdfauthor={Haohan Chen},
  hidelinks,
  pdfcreator={LaTeX via pandoc}}

\title{Data Wrangling (1)}
\author{Haohan Chen}
\date{Last update: 九月 28, 2023}

\begin{document}
\maketitle

\hypertarget{objectives-of-this-lecture}{%
\subsection{Objectives of this
Lecture}\label{objectives-of-this-lecture}}

This lecture introduces data wrangling with R. Using V-Dem data as an
example, we will learn how to use the wrangle data with a set of
\href{https://www.tidyverse.org/}{\texttt{tidyverse}} functionality.
Specifically, we will focus on functions\ldots{}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  to import and export data: \texttt{read\_csv} , \texttt{write\_csv}
  (with a brief introduction to other data import/ export functions from
  \href{https://readr.tidyverse.org/}{\texttt{readr}}).
\item
  to take a subset of \emph{columns} in the existing data:
  \texttt{select}
\item
  to rename columns: \texttt{rename}
\item
  to take a subset of \emph{rows} by some simple conditions:
  \texttt{slice\_}
\item
  to take a subset of \emph{rows} by some more complicated conditions:
  \texttt{filter}
\item
  to sort the rows based on the value of one or multiple columns:
  \texttt{arrange}
\item
  to perform (4) (5) (6) group by group: \texttt{group\_by},
  \texttt{ungroup}
\item
  to create new columns in the data: \texttt{group\_by},
  \texttt{mutate}, \texttt{ungroup}
\item
  to summarize the data: \texttt{group\_by}, \texttt{summarise},
  \texttt{ungroup}
\end{enumerate}

\hypertarget{outline-of-in-class-demo}{%
\subsection{Outline of In-Class Demo}\label{outline-of-in-class-demo}}

To demonstrate the above functionality, we will use real-world political
data from \href{https://v-dem.net/}{V-Dem}. Specifically, we will use
the above function to explore the state of global economic development
from 1984 to 2022. Our effort will take the following step (with
one-on-one mappings with the above tools).

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Read a part of pre-processed V-Dem data into R: 1984-2022 ``external''
  data in the V-Dem dataset.
\item
  Consulting the dataset's
  \href{https://github.com/haohanchen/HKU_POLI3148_23Fall/blob/main/_DataPublic_/vdem/documentation/codebook_v13.pdf}{codebook}
  and take a \textbf{subset} of indicators of \emph{economic
  development} (along with country-year identifiers).

  \begin{itemize}
  \item
    \emph{See a list of country-yer identifiers on p.~5 of the codebook
    (under ``1.7 Identifier Variables in the V-Dem Datasets'').}
  \item
    \emph{See a list of development indicators on p.~23 of the codebook
    (under ``9. Background Factors'').}
  \end{itemize}
\item
  Rename the column to name their names informative to readers.
\item
  Find the country-year with the \emph{highest} and \emph{lowest} level
  of economic development. In addition, create a dataset containing a
  random sample of country-year in the dataset.
\item
  Create a dataset focusing on the economic development of Asian
  countries and regions; Create a dataset that contains only countries/
  regions whose development level pass certain threshold.
\item
  Create a dataset whose rows are sorted by the development level of
  country-year.
\item
  Create a dataset that contains the year of the higest development
  level for each country/ region respectively.
\item
  Add the following economic indicators to the data:

  \begin{enumerate}
  \def\labelenumii{\arabic{enumii}.}
  \item
    Country-year development level with reference to that of 1984.
  \item
    Year-on-year economic growth.
  \end{enumerate}
\item
  Perform a data availability/ integrity check. Then aggregate the data
  into a new country-level dataset which contains the following
  indicators:

  \begin{enumerate}
  \def\labelenumii{\arabic{enumii}.}
  \item
    Average development level from 1984 to 2022.
  \item
    Magnitude of growth from 1984 to 2022.
  \end{enumerate}
\end{enumerate}

\hypertarget{in-class-exercise}{%
\subsection{In-Class Exercise}\label{in-class-exercise}}

The quality of education has a decisive effect on a country's future
development. Applying the data wrangling tools we introduce in this
lecture, perform the following task:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  \textbf{Coodbook lookup}. Look up the codebook, answer the following
  questions:

  \begin{enumerate}
  \def\labelenumii{\arabic{enumii}.}
  \item
    What indicators regarding the quality of education are available in
    the V-Dem datasets?
  \item
    What are the data's coverage (i.e., for which countries and years do
    we have data?)
  \item
    What are their sources? Provide the link to least 1 source.
  \end{enumerate}
\item
  \textbf{Subset by columns}

  \begin{enumerate}
  \def\labelenumii{\arabic{enumii}.}
  \item
    Create a dataset containing only the country-year identifiers and
    indicators of education quality.
  \item
    Rename the columns of education quality to make them informative.
  \end{enumerate}
\item
  \textbf{Subset by rows}

  \begin{enumerate}
  \def\labelenumii{\arabic{enumii}.}
  \item
    List 5 countries-years that have the highest education level among
    its population.
  \item
    List 5 countries-years that suffer from the most severe inequality
    in education.
  \end{enumerate}
\item
  \textbf{Summarize the data}

  \begin{enumerate}
  \def\labelenumii{\arabic{enumii}.}
  \item
    Check data availability: For which countries and years are the
    indicators of education quality available?
  \item
    Create two types of country-level indicators of education quality

    \begin{enumerate}
    \def\labelenumiii{\arabic{enumiii}.}
    \item
      Average level of education quality from 1984 to 2022
    \item
      Change of education quality from 1984 to 2022
    \end{enumerate}
  \item
    Examine the data and \emph{briefly} discuss: Which countries perform
    the best and the worst in terms of education quality in the past
    four decades?
  \end{enumerate}
\end{enumerate}

\textbf{Submission requirement:} You will submit your outputs through
Moodle. In your submission:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Attach a PDF document rendered by Rmarkdown
\item
  In the text field of your submission, include the link to the
  corresponding Rmarkdown file in your \emph{DaSPPA portfolio} GitHub
  repo.
\end{enumerate}

\textbf{Due:} October 4, 2023

\emph{Note:} \emph{Please} \emph{only use the functions we cover in this
lecture for this exercise. There is \ul{absolutely no need} to perform
any data visualization for this exercise\ldots{} We will get there in
later lectures.}

\hypertarget{further-reading}{%
\subsection{Further reading}\label{further-reading}}

\begin{itemize}
\item
  R for Data Science (2e) Chapters 4, 5, 8:
  \url{https://r4ds.hadley.nz/}
\item
  \texttt{readr} documentation (note: read the ``cheatsheet''):
  \url{https://readr.tidyverse.org/}
\item
  \texttt{dplyr} documentation (note: read the ``cheatsheet''):
  \url{https://dplyr.tidyverse.org/}
\item
  V-Dem documentation: \url{https://v-dem.net/}
\end{itemize}

\hypertarget{demo}{%
\subsection{Demo}\label{demo}}

\hypertarget{load-the-tidyverse-packages}{%
\subsubsection{\texorpdfstring{0. Load the \texttt{tidyverse}
Packages}{0. Load the tidyverse Packages}}\label{load-the-tidyverse-packages}}

This section loads the packages we need in this lecture.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(tidyverse)}
\end{Highlighting}
\end{Shaded}

\hypertarget{import-and-export-the-v-dem-data}{%
\subsubsection{1. Import and Export the V-Dem
Data}\label{import-and-export-the-v-dem-data}}

This section loads the VDEM dataset and describe its basic information

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{d }\OtherTok{\textless{}{-}} \FunctionTok{read\_csv}\NormalTok{(}\StringTok{"\_DataPublic\_/vdem/1984\_2022/vdem\_1984\_2022\_external.csv"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Rows: 6789 Columns: 211
## -- Column specification --------------------------------------------------------
## Delimiter: ","
## chr    (3): country_name, country_text_id, histname
## dbl  (207): country_id, year, project, historical, codingstart, codingend, c...
## date   (1): historical_date
## 
## i Use `spec()` to retrieve the full column specification for this data.
## i Specify the column types or set `show_col_types = FALSE` to quiet this message.
\end{verbatim}

getwd()

\hypertarget{select-economic-development-indicators}{%
\subsubsection{2. Select economic development
indicators}\label{select-economic-development-indicators}}

First, we look at the identifiers of the data.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{names}\NormalTok{(d)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   [1] "country_name"                "country_text_id"            
##   [3] "country_id"                  "year"                       
##   [5] "historical_date"             "project"                    
##   [7] "historical"                  "histname"                   
##   [9] "codingstart"                 "codingend"                  
##  [11] "codingstart_contemp"         "codingend_contemp"          
##  [13] "codingstart_hist"            "codingend_hist"             
##  [15] "gapstart1"                   "gapstart2"                  
##  [17] "gapstart3"                   "gapend1"                    
##  [19] "gapend2"                     "gapend3"                    
##  [21] "gap_index"                   "COWcode"                    
##  [23] "e_v2x_api_3C"                "e_v2x_api_4C"               
##  [25] "e_v2x_api_5C"                "e_v2x_civlib_3C"            
##  [27] "e_v2x_civlib_4C"             "e_v2x_civlib_5C"            
##  [29] "e_v2x_clphy_3C"              "e_v2x_clphy_4C"             
##  [31] "e_v2x_clphy_5C"              "e_v2x_clpol_3C"             
##  [33] "e_v2x_clpol_4C"              "e_v2x_clpol_5C"             
##  [35] "e_v2x_clpriv_3C"             "e_v2x_clpriv_4C"            
##  [37] "e_v2x_clpriv_5C"             "e_v2x_corr_3C"              
##  [39] "e_v2x_corr_4C"               "e_v2x_corr_5C"              
##  [41] "e_v2x_cspart_3C"             "e_v2x_cspart_4C"            
##  [43] "e_v2x_cspart_5C"             "e_v2x_delibdem_3C"          
##  [45] "e_v2x_delibdem_4C"           "e_v2x_delibdem_5C"          
##  [47] "e_v2x_EDcomp_thick_3C"       "e_v2x_EDcomp_thick_4C"      
##  [49] "e_v2x_EDcomp_thick_5C"       "e_v2x_egal_3C"              
##  [51] "e_v2x_egal_4C"               "e_v2x_egal_5C"              
##  [53] "e_v2x_egaldem_3C"            "e_v2x_egaldem_4C"           
##  [55] "e_v2x_egaldem_5C"            "e_v2x_elecoff_3C"           
##  [57] "e_v2x_elecoff_4C"            "e_v2x_elecoff_5C"           
##  [59] "e_v2x_execorr_3C"            "e_v2x_execorr_4C"           
##  [61] "e_v2x_execorr_5C"            "e_v2x_feduni_3C"            
##  [63] "e_v2x_feduni_4C"             "e_v2x_feduni_5C"            
##  [65] "e_v2x_frassoc_thick_3C"      "e_v2x_frassoc_thick_4C"     
##  [67] "e_v2x_frassoc_thick_5C"      "e_v2x_freexp_3C"            
##  [69] "e_v2x_freexp_4C"             "e_v2x_freexp_5C"            
##  [71] "e_v2x_freexp_altinf_3C"      "e_v2x_freexp_altinf_4C"     
##  [73] "e_v2x_freexp_altinf_5C"      "e_v2x_gencl_3C"             
##  [75] "e_v2x_gencl_4C"              "e_v2x_gencl_5C"             
##  [77] "e_v2x_gencs_3C"              "e_v2x_gencs_4C"             
##  [79] "e_v2x_gencs_5C"              "e_v2x_gender_3C"            
##  [81] "e_v2x_gender_4C"             "e_v2x_gender_5C"            
##  [83] "e_v2x_genpp_3C"              "e_v2x_genpp_4C"             
##  [85] "e_v2x_genpp_5C"              "e_v2x_jucon_3C"             
##  [87] "e_v2x_jucon_4C"              "e_v2x_jucon_5C"             
##  [89] "e_v2x_libdem_3C"             "e_v2x_libdem_4C"            
##  [91] "e_v2x_libdem_5C"             "e_v2x_liberal_3C"           
##  [93] "e_v2x_liberal_4C"            "e_v2x_liberal_5C"           
##  [95] "e_v2x_mpi_3C"                "e_v2x_mpi_4C"               
##  [97] "e_v2x_mpi_5C"                "e_v2x_partip_3C"            
##  [99] "e_v2x_partip_4C"             "e_v2x_partip_5C"            
## [101] "e_v2x_partipdem_3C"          "e_v2x_partipdem_4C"         
## [103] "e_v2x_partipdem_5C"          "e_v2x_polyarchy_3C"         
## [105] "e_v2x_polyarchy_4C"          "e_v2x_polyarchy_5C"         
## [107] "e_v2x_pubcorr_3C"            "e_v2x_pubcorr_4C"           
## [109] "e_v2x_pubcorr_5C"            "e_v2x_suffr_3C"             
## [111] "e_v2x_suffr_4C"              "e_v2x_suffr_5C"             
## [113] "e_v2xcl_rol_3C"              "e_v2xcl_rol_4C"             
## [115] "e_v2xcl_rol_5C"              "e_v2xcs_ccsi_3C"            
## [117] "e_v2xcs_ccsi_4C"             "e_v2xcs_ccsi_5C"            
## [119] "e_v2xdd_dd_3C"               "e_v2xdd_dd_4C"              
## [121] "e_v2xdd_dd_5C"               "e_v2xdl_delib_3C"           
## [123] "e_v2xdl_delib_4C"            "e_v2xdl_delib_5C"           
## [125] "e_v2xeg_eqdr_3C"             "e_v2xeg_eqdr_4C"            
## [127] "e_v2xeg_eqdr_5C"             "e_v2xeg_eqprotec_3C"        
## [129] "e_v2xeg_eqprotec_4C"         "e_v2xeg_eqprotec_5C"        
## [131] "e_v2xel_frefair_3C"          "e_v2xel_frefair_4C"         
## [133] "e_v2xel_frefair_5C"          "e_v2xel_locelec_3C"         
## [135] "e_v2xel_locelec_4C"          "e_v2xel_locelec_5C"         
## [137] "e_v2xel_regelec_3C"          "e_v2xel_regelec_4C"         
## [139] "e_v2xel_regelec_5C"          "e_v2xlg_legcon_3C"          
## [141] "e_v2xlg_legcon_4C"           "e_v2xlg_legcon_5C"          
## [143] "e_v2xme_altinf_3C"           "e_v2xme_altinf_4C"          
## [145] "e_v2xme_altinf_5C"           "e_v2xps_party_3C"           
## [147] "e_v2xps_party_4C"            "e_v2xps_party_5C"           
## [149] "e_boix_regime"               "e_democracy_breakdowns"     
## [151] "e_democracy_omitteddata"     "e_democracy_trans"          
## [153] "e_fh_cl"                     "e_fh_pr"                    
## [155] "e_fh_rol"                    "e_fh_status"                
## [157] "e_wbgi_cce"                  "e_wbgi_gee"                 
## [159] "e_wbgi_pve"                  "e_wbgi_rle"                 
## [161] "e_wbgi_rqe"                  "e_wbgi_vae"                 
## [163] "e_lexical_index"             "e_uds_median"               
## [165] "e_uds_mean"                  "e_uds_pct025"               
## [167] "e_uds_pct975"                "e_coups"                    
## [169] "e_legparty"                  "e_autoc"                    
## [171] "e_democ"                     "e_p_polity"                 
## [173] "e_polcomp"                   "e_polity2"                  
## [175] "e_bnr_dem"                   "e_chga_demo"                
## [177] "e_ti_cpi"                    "e_vanhanen"                 
## [179] "e_peaveduc"                  "e_peedgini"                 
## [181] "e_area"                      "e_regiongeo"                
## [183] "e_regionpol"                 "e_regionpol_6C"             
## [185] "e_cow_exports"               "e_cow_imports"              
## [187] "e_gdp"                       "e_gdp_sd"                   
## [189] "e_gdppc"                     "e_gdppc_sd"                 
## [191] "e_miinflat"                  "e_pop"                      
## [193] "e_pop_sd"                    "e_total_fuel_income_pc"     
## [195] "e_total_oil_income_pc"       "e_total_resources_income_pc"
## [197] "e_radio_n"                   "e_miferrat"                 
## [199] "e_mipopula"                  "e_miurbani"                 
## [201] "e_miurbpop"                  "e_pefeliex"                 
## [203] "e_peinfmor"                  "e_pelifeex"                 
## [205] "e_pematmor"                  "e_wb_pop"                   
## [207] "e_civil_war"                 "e_miinteco"                 
## [209] "e_miinterc"                  "e_pt_coup"                  
## [211] "e_pt_coup_attempts"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{d }\SpecialCharTok{|\textgreater{}} \FunctionTok{select}\NormalTok{(country\_name, country\_id, year) }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{distinct}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 6,789 x 3
##    country_name country_id  year
##    <chr>             <dbl> <dbl>
##  1 Mexico                3  1984
##  2 Mexico                3  1985
##  3 Mexico                3  1986
##  4 Mexico                3  1987
##  5 Mexico                3  1988
##  6 Mexico                3  1989
##  7 Mexico                3  1990
##  8 Mexico                3  1991
##  9 Mexico                3  1992
## 10 Mexico                3  1993
## # i 6,779 more rows
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# which countries are in this dateset}
\NormalTok{d }\SpecialCharTok{|\textgreater{}} \FunctionTok{select}\NormalTok{(country\_name) }\SpecialCharTok{|\textgreater{}} \FunctionTok{distinct}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 181 x 1
##    country_name 
##    <chr>        
##  1 Mexico       
##  2 Suriname     
##  3 Sweden       
##  4 Switzerland  
##  5 Ghana        
##  6 South Africa 
##  7 Japan        
##  8 Burma/Myanmar
##  9 Russia       
## 10 Albania      
## # i 171 more rows
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{d }\SpecialCharTok{|\textgreater{}} \FunctionTok{select}\NormalTok{(year)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 6,789 x 1
##     year
##    <dbl>
##  1  1984
##  2  1985
##  3  1986
##  4  1987
##  5  1988
##  6  1989
##  7  1990
##  8  1991
##  9  1992
## 10  1993
## # i 6,779 more rows
\end{verbatim}

select both the country identifiers, GDP, and GDP per capita.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{d }\SpecialCharTok{|\textgreater{}} \FunctionTok{select}\NormalTok{(country\_name, country\_id, year, e\_gdp, e\_gdppc)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 6,789 x 5
##    country_name country_id  year   e_gdp e_gdppc
##    <chr>             <dbl> <dbl>   <dbl>   <dbl>
##  1 Mexico                3  1984  93563.    11.7
##  2 Mexico                3  1985  94259.    11.5
##  3 Mexico                3  1986  92750.    11.1
##  4 Mexico                3  1987  93220.    10.9
##  5 Mexico                3  1988  94687.    10.8
##  6 Mexico                3  1989  98145.    11.0
##  7 Mexico                3  1990 103254.    11.4
##  8 Mexico                3  1991 107374.    11.6
##  9 Mexico                3  1992 111533.    11.9
## 10 Mexico                3  1993 114611.    12.0
## # i 6,779 more rows
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{d\_gdp }\OtherTok{\textless{}{-}}\NormalTok{ d }\SpecialCharTok{|\textgreater{}}
\FunctionTok{select}\NormalTok{(country\_name, country\_id, year, e\_gdp, e\_gdppc)}
\NormalTok{d\_gdp}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 6,789 x 5
##    country_name country_id  year   e_gdp e_gdppc
##    <chr>             <dbl> <dbl>   <dbl>   <dbl>
##  1 Mexico                3  1984  93563.    11.7
##  2 Mexico                3  1985  94259.    11.5
##  3 Mexico                3  1986  92750.    11.1
##  4 Mexico                3  1987  93220.    10.9
##  5 Mexico                3  1988  94687.    10.8
##  6 Mexico                3  1989  98145.    11.0
##  7 Mexico                3  1990 103254.    11.4
##  8 Mexico                3  1991 107374.    11.6
##  9 Mexico                3  1992 111533.    11.9
## 10 Mexico                3  1993 114611.    12.0
## # i 6,779 more rows
\end{verbatim}

\hypertarget{rename-column-to-make-names-informative}{%
\subsubsection{3. Rename Column to make names
informative}\label{rename-column-to-make-names-informative}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{d\_gdp }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{rename}\NormalTok{(}\StringTok{"GDP"}\OtherTok{=}\StringTok{"e\_gdp"}\NormalTok{, }\StringTok{"GDP\_per\_capita"} \OtherTok{=}\StringTok{"e\_gdppc"}\NormalTok{, }\StringTok{"country"} \OtherTok{=} \StringTok{"country\_name"}\NormalTok{, }\StringTok{"ID"}\OtherTok{=}\StringTok{"country\_id"}\NormalTok{, }\StringTok{"Year"} \OtherTok{=} \StringTok{"year"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 6,789 x 5
##    country    ID  Year     GDP GDP_per_capita
##    <chr>   <dbl> <dbl>   <dbl>          <dbl>
##  1 Mexico      3  1984  93563.           11.7
##  2 Mexico      3  1985  94259.           11.5
##  3 Mexico      3  1986  92750.           11.1
##  4 Mexico      3  1987  93220.           10.9
##  5 Mexico      3  1988  94687.           10.8
##  6 Mexico      3  1989  98145.           11.0
##  7 Mexico      3  1990 103254.           11.4
##  8 Mexico      3  1991 107374.           11.6
##  9 Mexico      3  1992 111533.           11.9
## 10 Mexico      3  1993 114611.           12.0
## # i 6,779 more rows
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{print}\NormalTok{(d\_gdp)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 6,789 x 5
##    country_name country_id  year   e_gdp e_gdppc
##    <chr>             <dbl> <dbl>   <dbl>   <dbl>
##  1 Mexico                3  1984  93563.    11.7
##  2 Mexico                3  1985  94259.    11.5
##  3 Mexico                3  1986  92750.    11.1
##  4 Mexico                3  1987  93220.    10.9
##  5 Mexico                3  1988  94687.    10.8
##  6 Mexico                3  1989  98145.    11.0
##  7 Mexico                3  1990 103254.    11.4
##  8 Mexico                3  1991 107374.    11.6
##  9 Mexico                3  1992 111533.    11.9
## 10 Mexico                3  1993 114611.    12.0
## # i 6,779 more rows
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(dplyr)}
\NormalTok{d\_gdp }\OtherTok{\textless{}{-}}\NormalTok{ d\_gdp }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{rename}\NormalTok{( }\StringTok{"GDP"}\OtherTok{=}\StringTok{"e\_gdp"}\NormalTok{, }\StringTok{"GDP\_per\_capita"} \OtherTok{=}\StringTok{"e\_gdppc"}\NormalTok{, }\StringTok{"country"} \OtherTok{=} \StringTok{"country\_name"}\NormalTok{, }\StringTok{"ID"}\OtherTok{=}\StringTok{"country\_id"}\NormalTok{, }\StringTok{"Year"} \OtherTok{=} \StringTok{"year"}\NormalTok{)}
\FunctionTok{print}\NormalTok{(d\_gdp)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 6,789 x 5
##    country    ID  Year     GDP GDP_per_capita
##    <chr>   <dbl> <dbl>   <dbl>          <dbl>
##  1 Mexico      3  1984  93563.           11.7
##  2 Mexico      3  1985  94259.           11.5
##  3 Mexico      3  1986  92750.           11.1
##  4 Mexico      3  1987  93220.           10.9
##  5 Mexico      3  1988  94687.           10.8
##  6 Mexico      3  1989  98145.           11.0
##  7 Mexico      3  1990 103254.           11.4
##  8 Mexico      3  1991 107374.           11.6
##  9 Mexico      3  1992 111533.           11.9
## 10 Mexico      3  1993 114611.           12.0
## # i 6,779 more rows
\end{verbatim}

\hypertarget{slice-rows}{%
\subsubsection{4. slice rows}\label{slice-rows}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# want countries{-}years with }
\NormalTok{d\_gdp }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{slice\_max}\NormalTok{(}\AttributeTok{order\_by=}\NormalTok{ GDP , }\AttributeTok{n=}\DecValTok{10}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 10 x 5
##    country                     ID  Year      GDP GDP_per_capita
##    <chr>                    <dbl> <dbl>    <dbl>          <dbl>
##  1 China                      110  2019 2279809.           15.4
##  2 China                      110  2018 2205730.           14.9
##  3 China                      110  2017 2136176.           14.5
##  4 United States of America    20  2019 2118706.           60.6
##  5 United States of America    20  2018 2077898.           59.6
##  6 China                      110  2016 2039529.           13.9
##  7 United States of America    20  2017 2023242.           58.5
##  8 United States of America    20  2016 1980809.           57.6
##  9 China                      110  2015 1953127.           13.3
## 10 United States of America    20  2015 1942092.           56.7
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{d\_gdp }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{slice\_sample}\NormalTok{(}\AttributeTok{n =} \DecValTok{10}\NormalTok{) }\CommentTok{\# sample 10 observations}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 10 x 5
##    country          ID  Year    GDP GDP_per_capita
##    <chr>         <dbl> <dbl>  <dbl>          <dbl>
##  1 Singapore       200  2003 18876.         41.6  
##  2 Burma/Myanmar    10  1993  4363.          0.998
##  3 Zanzibar        236  2015    NA          NA    
##  4 Honduras         27  1997  2170.          3.43 
##  5 Cameroon        108  2000  3795.          2.27 
##  6 Portugal         21  1994 20367.         19.3  
##  7 Belarus         107  2005 13206.         12.8  
##  8 Guatemala        78  1989  3951.          4.24 
##  9 Cyprus          156  1990  1375.         19.2  
## 10 Togo            134  2020    NA          NA
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{d\_gdp }\SpecialCharTok{|\textgreater{}}
  \FunctionTok{slice\_sample}\NormalTok{(}\AttributeTok{prop =} \FloatTok{0.1}\NormalTok{) }
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 678 x 5
##    country          ID  Year     GDP GDP_per_capita
##    <chr>         <dbl> <dbl>   <dbl>          <dbl>
##  1 Kuwait          171  2006  17005.          65.9 
##  2 Argentina        37  2012  76871.          17.4 
##  3 Rwanda          129  2009   1610.           1.56
##  4 India            39  2005 400127.           3.37
##  5 Poland           17  2004  61470.          15.1 
##  6 Poland           17  2001  55474.          13.5 
##  7 Gabon           116  1999   1304.          10.5 
##  8 Syria            97  2022     NA           NA   
##  9 Guinea-Bissau   119  2016    290.           1.53
## 10 Malta           178  2016   1689.          34.9 
## # i 668 more rows
\end{verbatim}

\hypertarget{subset-data-by-row}{%
\subsubsection{5. Subset data by row}\label{subset-data-by-row}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# want :2000{-}2005 data }
\NormalTok{d\_gdp }\SpecialCharTok{|\textgreater{}}
   \FunctionTok{filter}\NormalTok{(Year }\SpecialCharTok{\textgreater{}=} \DecValTok{2000} \SpecialCharTok{\&}\NormalTok{ Year }\SpecialCharTok{\textgreater{}=} \DecValTok{2005}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 3,214 x 5
##    country    ID  Year     GDP GDP_per_capita
##    <chr>   <dbl> <dbl>   <dbl>          <dbl>
##  1 Mexico      3  2005 162094.           14.3
##  2 Mexico      3  2006 167392.           14.6
##  3 Mexico      3  2007 171691.           14.7
##  4 Mexico      3  2008 174204.           14.8
##  5 Mexico      3  2009 171739.           14.4
##  6 Mexico      3  2010 178865.           14.8
##  7 Mexico      3  2011 185824.           15.1
##  8 Mexico      3  2012 192272.           15.4
##  9 Mexico      3  2013 196480.           15.6
## 10 Mexico      3  2014 201281.           15.7
## # i 3,204 more rows
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{d\_gdp }\SpecialCharTok{|\textgreater{}} 
  \FunctionTok{filter}\NormalTok{(country }\SpecialCharTok{==} \StringTok{"China"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 39 x 5
##    country    ID  Year     GDP GDP_per_capita
##    <chr>   <dbl> <dbl>   <dbl>          <dbl>
##  1 China     110  1984 243976.           2.21
##  2 China     110  1985 265805.           2.36
##  3 China     110  1986 285707.           2.50
##  4 China     110  1987 308227.           2.65
##  5 China     110  1988 322596.           2.73
##  6 China     110  1989 327739.           2.74
##  7 China     110  1990 315683.           2.63
##  8 China     110  1991 329836.           2.71
##  9 China     110  1992 359817.           2.90
## 10 China     110  1993 393449.           3.15
## # i 29 more rows
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{d\_gdp }\SpecialCharTok{|\textgreater{}} \FunctionTok{filter}\NormalTok{(Year }\SpecialCharTok{\textgreater{}=} \DecValTok{2000} \SpecialCharTok{\&}\NormalTok{ Year }\SpecialCharTok{\textless{}=} \DecValTok{2005}\SpecialCharTok{|}\NormalTok{country }\SpecialCharTok{==} \StringTok{"China"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 1,095 x 5
##    country     ID  Year     GDP GDP_per_capita
##    <chr>    <dbl> <dbl>   <dbl>          <dbl>
##  1 Mexico       3  2000 145206.          13.7 
##  2 Mexico       3  2001 146993.          13.6 
##  3 Mexico       3  2002 148549.          13.6 
##  4 Mexico       3  2003 151035.          13.7 
##  5 Mexico       3  2004 156578.          14.1 
##  6 Mexico       3  2005 162094.          14.3 
##  7 Suriname     4  2000    383.           7.67
##  8 Suriname     4  2001    402.           7.93
##  9 Suriname     4  2002    423.           8.25
## 10 Suriname     4  2003    451.           8.67
## # i 1,085 more rows
\end{verbatim}

\hypertarget{arrange}{%
\subsubsection{6. Arrange}\label{arrange}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#want: sort the row by GDP per capita}
\NormalTok{d\_gdp }\SpecialCharTok{|\textgreater{}} \FunctionTok{arrange}\NormalTok{(GDP\_per\_capita)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 6,789 x 5
##    country                             ID  Year    GDP GDP_per_capita
##    <chr>                            <dbl> <dbl>  <dbl>          <dbl>
##  1 Liberia                             86  1995   62.3          0.286
##  2 Liberia                             86  1994   65.5          0.307
##  3 Liberia                             86  1996   70.6          0.309
##  4 Liberia                             86  1993   81.5          0.383
##  5 Liberia                             86  1997  107.           0.429
##  6 Liberia                             86  1992  113.           0.53 
##  7 Democratic Republic of the Congo   111  2002 2966.           0.538
##  8 Democratic Republic of the Congo   111  2001 2890.           0.54 
##  9 Liberia                             86  1998  147.           0.543
## 10 Democratic Republic of the Congo   111  2003 3141.           0.552
## # i 6,779 more rows
\end{verbatim}

\end{document}
